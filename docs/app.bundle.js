!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e,i){this.a=t,this.b=e,this.c=i}function r(t,e){this.x=t,this.y=e}i.r(e),n.prototype.intersect=function(t){var e=this.a*t.b-this.b*t.a;if(0==e)throw new Error("Error: lines do not intersect");return new r((this.b*t.c-this.c*t.b)/e,(this.c*t.a-this.a*t.c)/e)},r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r.prototype.subtract=function(t){return new r(this.x-t.x,this.y-t.y)},r.prototype.add=function(t){return new r(this.x+t.x,this.y+t.y)},r.prototype.rotate90Clockwise=function(){return new r(this.y,-this.x)},r.prototype.rotate90CounterClockwise=function(){return new r(-this.y,this.x)},r.prototype.dot=function(t){return this.x*t.x+this.y*t.y},r.prototype.scale=function(t){return new r(t*this.x,t*this.y)},r.prototype.normalize=function(){return this.scale(1/this.norm())},r.prototype.neg=function(){return new r(-this.x,-this.y)},r.prototype.toString=function(){return"(".concat(this.x.toString(),", ").concat(this.y.toString(),")")},r.prototype.midpoint=function(t){return new r((this.x+t.x)/2,(this.y+t.y)/2)},r.prototype.join=function(t){return new n(this.y-t.y,t.x-this.x,this.x*t.y-this.y*t.x)},r.prototype.cxConj=function(){return new r(this.x,-this.y)},r.prototype.normSquared=function(){return this.x*this.x+this.y*this.y},r.prototype.norm=function(){return Math.sqrt(this.normSquared())},r.prototype.cxInv=function(){return this.cxConj().scale(1/this.normSquared())},r.prototype.cxMult=function(t){return new r(this.x*t.x-this.y*t.y,this.x*t.y+this.y*t.x)};var s={triangleSign:function(t,e,i){var n=e.getX()-t.getX(),r=e.getY()-t.getY(),o=i.getX()-t.getX(),a=n*(i.getY()-t.getY())-r*o;return s.signum(a)},rightOf:function(t,e){return 0<s.triangleSign(t.start(),e,t.end())},lengthSquared:function(t){return(t.start().getX()-t.end().getX())*(t.start().getX()-t.end().getX())+(t.start().getY()-t.end().getY())*(t.start().getY()-t.end().getY())},reflectIn:function(t,e){var i=e.subtract(t.start()),n=t.end().subtract(t.start());return i.cxMult(n.cxConj()).cxConj().cxMult(n).scale(1/n.normSquared()).add(t.start())},reflectDir:function(t,e){var i=t.end().subtract(t.start());return e.cxMult(i.cxConj()).cxConj().cxMult(i).scale(1/i.normSquared())},signum:function(t){return 0===t?0:0<t?1:-1}},o=s;function a(t,e){this.p=t,this.i=0<=e?e%this.p.numSides():this.p.numSides()-e%this.p.numSides()}function h(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}function l(){this.xValues=[],this.yValues=[],this.startX=null,this.startY=null,this.closed=!1}function c(){this.tiling=null}function u(t,e,i){c.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[new r(0,0),new r(this.tiling.t,0),new r(1,0),new r(1,1),new r(1-this.tiling.t,1),new r(0,1)],this.xt=new r(1,0),this.yt=new r(1-this.tiling.t,1)}function p(t){this.t=t}function g(t,e,i){c.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[new r(0,0),new r(1,0),new r(this.tiling.x+1,this.tiling.y),new r(this.tiling.x,this.tiling.y)],this.xt=new r(1,0),this.yt=new r(this.tiling.x,this.tiling.y)}function d(t,e){this.x=t,this.y=e}function f(t,e,i){c.call(this),this.tiling=t,this.a=e,this.b=i}function y(t,e,i){f.call(this,t,e,i),this.v=[new r(1,0),new r(this.tiling.x+1,this.tiling.y),new r(this.tiling.x,this.tiling.y)],this.xt=new r(1,0),this.yt=new r(this.tiling.x,this.tiling.y)}function m(t,e,i){f.call(this,t,e,i),this.v=[new r(0,0),new r(1,0),new r(this.tiling.x,this.tiling.y)],this.xt=new r(1,0),this.yt=new r(this.tiling.x,this.tiling.y)}function w(t,e){this.x=t,this.y=e}function x(t,e,i){c.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[],this.xt=new r(this.tiling.m,this.tiling.n),this.yt=new r(-this.tiling.n,this.tiling.m)}function v(t,e,i){x.call(this,t,e,i),this.v=[new r(this.tiling.m,0),new r(this.tiling.m+this.tiling.n,0),new r(this.tiling.m+this.tiling.n,this.tiling.n),new r(this.tiling.m,this.tiling.n)]}function b(t,e,i){x.call(this,t,e,i),this.v=[new r(0,0),new r(this.tiling.n,0),new r(this.tiling.m,0),new r(this.tiling.m,this.tiling.n),new r(this.tiling.m,this.tiling.m),new r(this.tiling.m-this.tiling.n,this.tiling.m),new r(0,this.tiling.m),new r(0,this.tiling.m-this.tiling.n)]}function S(t,e){if(e<t)this.m=t,this.n=e;else{if(!(t<e))throw new Error("called new TwoSquareTiling(length1,length2) with length1 = length2");this.m=e,this.n=t}}a.prototype.getI=function(){return this.i},a.prototype.end=function(){return this.p.getV(this.i+1)},a.prototype.start=function(){return this.p.getV(this.i)},a.prototype.nextEdge=function(){return new a(this.p,this.i+1)},a.prototype.previousEdge=function(){return new a(this.p,this.i+1)},a.prototype.opposite=function(){return this.p.getO(this.i)},a.prototype.getMidpoint=function(){return this.start().midpoint(this.end())},a.prototype.reflect=function(t){return o.reflectIn(this,t)},a.prototype.reflectDir=function(t){return o.reflectDir(this,t)},a.prototype.getPolygon=function(){return this.p},a.prototype.toLine=function(){return this.start().join(this.end())},h.prototype.getX=function(){return this.x},h.prototype.getY=function(){return this.y},h.prototype.getWidth=function(){return this.width},h.prototype.getHeight=function(){return this.height},h.prototype.getCenterX=function(){return this.getMinX()+this.width/2},h.prototype.getCenterY=function(){return this.getMinY()+this.height/2},h.prototype.getMinX=function(){return this.x},h.prototype.getMinY=function(){return this.y-this.height},l.prototype.moveTo=function(t,e){this.xValues=[],this.yValues=[],this.xValues.push(t),this.yValues.push(e),this.closed=!1,this.startX=t,this.startY=e},l.prototype.lineTo=function(t,e){if(closed)throw new Error("Attempting to manipulate a closed path.");this.xValues.push(t),this.yValues.push(e)},l.prototype.copy=function(){var t=new l;return t.xValues=this.xValues.slice(0),t.yValues=this.yValues.slice(0),t.startX=this.startX,t.startY=this.startY,t.closed=this.closed,t},l.prototype.closePath=function(){this.closed=!0,this.xValues.push(this.startX),this.yValues.push(this.startY)},l.prototype.toString=function(){for(var t="M".concat(this.xValues[0].toString(),",").concat(this.yValues[0].toString()),e=1;e<this.xValues.length;e++)t="".concat(t,"L").concat(this.xValues[e].toString(),",").concat(this.yValues[e].toString());return t},l.prototype.getBoundingBox=function(){var t=Raphael.pathBBox(this.toString());return new h(t.x,t.y2,t.width,t.height)},c.prototype.getV=function(t){var e=t%this.numSides();return e<0?this.getVertex(e+this.numSides()):this.getVertex(e)},c.prototype.getEdge=function(t){return new a(this,t)},c.prototype.getO=function(t){var e=t%this.numSides();return e<0?this.getOpposite(e+this.numSides()):this.getOpposite(e)},c.prototype.getPath=function(){var t=new l,e=this.getVertex(0);t.moveTo(e.getX(),e.getY());for(var i=1;i<this.numSides();i++)e=this.getVertex(i),t.lineTo(e.getX(),e.getY());return t.closePath(),t},c.prototype.getCenterOfMass=function(){for(var t=0,e=0,i=this.numSides(),n=0;n<i;n++){var s=this.getVertex(n);t+=s.getX(),e+=s.getY()}return new r(t/i,e/i)},c.prototype.tilingToString=function(){return this.tiling.toString()},(u.prototype=Object.create(c.prototype)).numSides=function(){return 6},u.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},u.prototype.getOpposite=function(t){switch(t){case 0:return new a(new u(this.tiling,this.a,this.b-1),3);case 1:return new a(new u(this.tiling,this.a+1,this.b-1),4);case 2:return new a(new u(this.tiling,this.a+1,this.b),5);case 3:return new a(new u(this.tiling,this.a,this.b+1),0);case 4:return new a(new u(this.tiling,this.a-1,this.b+1),1);case 5:return new a(new u(this.tiling,this.a-1,this.b),2);default:throw new Error("Called getOpposite() with invalid i.")}},p.prototype.getOriginPolygon=function(){return new u(this,0,0)},p.prototype.toString=function(){return"BrickTiling ".concat(this.t.toString())},p.prototype.fromParameters=function(t){return new p(function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,1)[0])},(g.prototype=Object.create(c.prototype)).numSides=function(){return 4},g.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},g.prototype.getOpposite=function(t){switch(t){case 0:return new a(new g(this.tiling,this.a,this.b-1),2);case 1:return new a(new g(this.tiling,this.a+1,this.b),3);case 2:return new a(new g(this.tiling,this.a,this.b+1),0);case 3:return new a(new g(this.tiling,this.a-1,this.b),1);default:throw new Error("Called getOpposite() with invalid i.")}},d.prototype.getOriginPolygon=function(){return new g(this,0,0)},d.prototype.toString=function(){return"ParallelogramTiling ".concat(this.x.toString()," ").concat(this.y.toString())},d.prototype.fromParameters=function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),i=e[0],n=e[1];return new d(i*Math.cos(n*Math.PI/180),i*Math.sin(n*Math.PI/180))},(f.prototype=Object.create(c.prototype)).getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},(y.prototype=Object.create(f.prototype)).numSides=function(){return 3},y.prototype.getOpposite=function(t){switch(t){case 0:return new a(new m(this.tiling,this.a+1,this.b),2);case 1:return new a(new m(this.tiling,this.a,this.b+1),0);case 2:return new a(new m(this.tiling,this.a,this.b),1);default:throw new Error("Called getOpposite() on a DownTriangle with invalid i=".concat(t))}},(m.prototype=Object.create(f.prototype)).numSides=function(){return 3},m.prototype.getOpposite=function(t){switch(t){case 0:return new a(new y(this.tiling,this.a,this.b-1),1);case 1:return new a(new y(this.tiling,this.a,this.b),2);case 2:return new a(new y(this.tiling,this.a-1,this.b),0);default:throw new Error("Called getOpposite() on a UpTriangle with invalid i=".concat(t))}},w.prototype.getOriginPolygon=function(){return new m(this,0,0)},w.prototype.fromParameters=function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,1)[0],i=t[1]*Math.PI/180;return new w(e*Math.cos(i),e*Math.sin(i))},w.prototype.fromAngles=function(t){var e=t[0]*Math.PI/180,i=t[1]*Math.PI/180;return new w(Math.tan(e)/(Math.tan(i)+Math.tan(e)),Math.tan(e)*Math.tan(i)/(Math.tan(i)+Math.tan(e)))},(x.prototype=Object.create(c.prototype)).translate=function(t,e){return new r(t+this.a*this.tiling.m-this.b*this.tiling.n,e+this.a*this.tiling.n+this.b*this.tiling.m)},x.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},(v.prototype=Object.create(x.prototype)).numSides=function(){return 4},v.prototype.getOpposite=function(t){switch(t){case 0:return new a(new b(this.tiling,this.a,this.b-1),4);case 1:return new a(new b(this.tiling,this.a+1,this.b-1),6);case 2:return new a(new b(this.tiling,this.a+1,this.b),0);case 3:return new a(new b(this.tiling,this.a,this.b),2);default:throw new Error("Called getOpposite() with invalid i.")}},(b.prototype=Object.create(x.prototype)).numSides=function(){return 8},b.prototype.getOpposite=function(t){switch(t){case 0:return new a(new v(this.tiling,this.a-1,this.b),2);case 1:return new a(new b(this.tiling,this.a,this.b-1),5);case 2:return new a(new v(this.tiling,this.a,this.b),3);case 3:return new a(new b(this.tiling,this.a+1,this.b),7);case 4:return new a(new v(this.tiling,this.a,this.b+1),4);case 5:return new a(new b(this.tiling,this.a,this.b+1),1);case 6:return new a(new v(this.tiling,this.a-1,this.b+1),1);case 7:return new a(new b(this.tiling,this.a-1,this.b),3);default:throw new Error("Called getOpposite() with invalid i.")}},S.prototype.toString=function(){return"TwoSquareTiling ".concat(this.m," ").concat(this.n)},S.prototype.getOriginPolygon=function(){return new b(this,0,0)},S.prototype.fromParameters=function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),i=e[0],n=e[1];return i!==n?new S(i,n):new p(0)};var I={initialDisplayBoxScale:5,nudgeAmt:.015,screenShift:.02,trajectoryEndpointRadius:5,trajectoryIters:100,backgroundColor:"white",polyColor:"lightgrey",polyStrokeColor:"blue",orbitColor:"red",startCircleColor:"green",endCircleColor:"red",draggingCircleColor:"yellow",endTrajectoryColor:"pink",zoomBoxStrokeColor:"orange",directionMap:{up:0,left:1,down:2,right:3,w:0,a:1,s:2,d:3},zoomScaleMap:{i:.9,o:1.1},moveTrajPointsMap:{alt:!1,shift:!0}},T={"set-iters":{name:"Set Iterations",message:"This sets the number of iterations computed, N. The default is ".concat(I.trajectoryIters,".")+" We won't enforce a maximum, but even 10,000 takes a while.",parameters:[{name:"Iterations",placeholder:"N",id:"N",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY}],newTiling:!1,tiling:void 0},parallelogram:{name:"Parallelogram Tiling",message:"This window sets the tiling to the standard tiling by parallelograms with  sides of length 1 and L, and an angle &#952; measured in degrees.",parameters:[{name:"Length",placeholder:"L",id:"L",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY},{name:"Angle",placeholder:"&#952;",id:"theta",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180}],newTiling:!0,tiling:d.prototype.fromParameters},triangle:{name:"Triangle Tiling",message:"This window sets the tiling to the standard tiling by triangulated parallelograms with sides of length 1 and L, and an angle &#952; measured in  degrees. The diagonal is opposite &#952;.",parameters:[{name:"Length",placeholder:"L",id:"L",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY},{name:"Angle",placeholder:"&#952;",id:"theta",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180}],newTiling:!0,tiling:w.prototype.fromParameters},"triangle-angles":{name:"Triangle Tiling",message:"This window sets the tiling to the standard tiling by triangulated parallelograms with angles &#966; and &#952; (both measured in degrees), and a base  length of 1. The diagonal is opposite &#952;.",parameters:[{name:"Angle &#966;",placeholder:"&#966;",id:"phi",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180},{name:"Angle &#952;",placeholder:"&#952;",id:"theta",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180}],newTiling:!0,tiling:w.prototype.fromAngles},brick:{name:"Brick Tiling",message:"This window constructs the tiling by square bricks with offset T, a real number between zero and one.",parameters:[{name:"Offset",placeholder:"T",id:"T",minInclusive:0,minExclusive:Number.NEGATIVE_INFINITY,maxInclusive:1,maxExclusive:Number.POSITIVE_INFINITY}],newTiling:!0,tiling:p.prototype.fromParameters},"two-square":{name:"Two Square Tiling",message:"This window sets the tiling to two-square tiling with side-lengths L<sub>1</sub> and L<sub>2</sub>.",parameters:[{name:"Length 1",placeholder:"L_1",id:"L_1",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY},{name:"Length 2",placeholder:"L_2",id:"L_2",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY}],newTiling:!0,tiling:S.prototype.fromParameters}};function E(t,e,i){c.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[],this.xt=new r(2,0),this.yt=new r(-1,Math.sqrt(3))}function j(t,e,i){E.call(this,t,e,i),this.v=[new r(1,0),new r(1.5,Math.sqrt(3)/2),new r(.5,Math.sqrt(3)/2)]}function P(t,e,i){E.call(this,t,e,i),this.v=[new r(1,0),new r(.5,-Math.sqrt(3)/2),new r(1.5,-Math.sqrt(3)/2)]}function M(t,e,i){E.call(this,t,e,i),this.v=[new r(1,0),new r(.5,Math.sqrt(3)/2),new r(-.5,Math.sqrt(3)/2),new r(-1,0),new r(-.5,-Math.sqrt(3)/2),new r(.5,-Math.sqrt(3)/2)]}function O(){}function B(t){this.paper=t}function C(t,e){this.displayBox=t,this.currentTransform=new Raphael.matrix(1,0,0,0,1,0),this.c=e}function Y(t,e,i){this.component=t,this.tm=new C(new h(-2,2,4,4),t),this.p=e,this.frame=i}function X(t){this.d=t,this.p=null}function k(t,e,i){for(this.s=e,this.dir=i.subtract(this.s).normalize(),this.edge=t.getEdge(0);o.triangleSign(i,this.edge.start(),this.s)<=0;)if(this.edge=this.edge.nextEdge(),0===this.edge.getI())throw new Error("WHAT IS HAPPENING");for(;0<o.triangleSign(i,this.edge.end(),this.s);)this.edge=this.edge.nextEdge()}function V(t){this.d=t,this.s=null,this.e=null,this.traj=[],this.polys=[],this.L=I.trajectoryIters,this.R=I.trajectoryEndpointRadius,this.orbitColor=I.orbitColor,this.trajectoryPath=null,this.polygonPathSet=[],this.circles=[],this.reset()}function L(t,e){this.d=new Y(e,t,this),this.d.tm.setDisplayBox(t.getPath().getBoundingBox()),this.d.tm.scale(I.initialDisplayBoxScale),this.initialDisplayBox=this.d.tm.getDisplayBox(),this.polyLayer=new X(this.d),this.polyLayer.render(),this.zoomBox=null,this.trajLayer=new V(this.d),this.trajLayer.render(),Mousetrap.bind("up",this.move.bind(this)),Mousetrap.bind("left",this.move.bind(this)),Mousetrap.bind("down",this.move.bind(this)),Mousetrap.bind("right",this.move.bind(this)),Mousetrap.bind("o",this.zoom.bind(this)),Mousetrap.bind("i",this.zoom.bind(this)),Mousetrap.bind("r",this.zoom.bind(this)),Mousetrap.bind("w",this.moveTrajPoints.bind(this)),Mousetrap.bind("a",this.moveTrajPoints.bind(this)),Mousetrap.bind("s",this.moveTrajPoints.bind(this)),Mousetrap.bind("d",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+w",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+a",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+s",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+d",this.moveTrajPoints.bind(this)),Mousetrap.bind("esc",this.toggleHelpBox.bind(this)),document.onmousedown=this.mouseEvent.bind(this),document.onmouseup=this.mouseEvent.bind(this),document.onmousemove=this.mouseEvent.bind(this)}function N(t){var e=window.innerWidth,i=window.innerHeight,n=new B(Raphael(0,0,e,i));return n.setBackgroundColor(I.backgroundColor),window.frame=new L(t.getOriginPolygon(),n),window.frame}function q(t,e,i){c.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[],this.xt=new r(2+Math.sqrt(2),-2-Math.sqrt(2)),this.yt=new r(2+Math.sqrt(2),2+Math.sqrt(2))}function D(t,e,i){q.call(this,t,e,i),this.v=[new r(0,0),new r(0,-2),new r(2,-2),new r(2,0)]}function z(t,e,i){q.call(this,t,e,i),this.v=[new r(0,0),new r(2,0),new r(2+Math.sqrt(2),Math.sqrt(2)),new r(2+Math.sqrt(2),2+Math.sqrt(2)),new r(2,2+2*Math.sqrt(2)),new r(0,2+2*Math.sqrt(2)),new r(-Math.sqrt(2),2+Math.sqrt(2)),new r(-Math.sqrt(2),Math.sqrt(2))]}function F(){}function H(t,e){var i=$("input[name=".concat(e,"]")).parent(".input-group").parent(".form-group");i.removeClass("has-success"),i.addClass("has-feedback has-error"),i.children(".input-group").children(".glyphicon").removeClass("glyphicon-ok"),i.children(".input-group").children(".glyphicon").addClass("glyphicon-remove"),$("#error-messages").append('<span id="'.concat(e,'">').concat(t,"</span><br>"))}(E.prototype=Object.create(c.prototype)).getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},E.prototype.compareTo=function(t){return O.compare(this,t)},(j.prototype=Object.create(E.prototype)).numSides=function(){return 3},j.prototype.getOpposite=function(t){switch(t){case 0:return new a(new M(this.tiling,this.a+1,this.b),2);case 1:return new a(new M(this.tiling,this.a+1,this.b+1),4);case 2:return new a(new M(this.tiling,this.a,this.b),0);default:throw new Error("Called getOpposite() on a HexDownTriangle with invalid i=".concat(t))}},(P.prototype=Object.create(E.prototype)).numSides=function(){return 3},P.prototype.getOpposite=function(t){switch(t){case 0:return new a(new M(this.tiling,this.a,this.b),5);case 1:return new a(new M(this.tiling,this.a,this.b-1),1);case 2:return new a(new M(this.tiling,this.a+1,this.b),3);default:throw new Error("Called getOpposite() on a HexUpTriangle with invalid i=".concat(t))}},(M.prototype=Object.create(E.prototype)).numSides=function(){return 6},M.prototype.getOpposite=function(t){switch(t){case 0:return new a(new j(this.tiling,this.a,this.b),2);case 1:return new a(new P(this.tiling,this.a,this.b+1),1);case 2:return new a(new j(this.tiling,this.a-1,this.b),0);case 3:return new a(new P(this.tiling,this.a-1,this.b),2);case 4:return new a(new j(this.tiling,this.a-1,this.b-1),1);case 5:return new a(new P(this.tiling,this.a,this.b),0);default:throw new Error("Called getOpposite() on a Hexagon with invalid i=".concat(t))}},O.prototype.getOriginPolygon=function(){return new M(this,0,0)},O.prototype.toString=function(){return"HexagonTriangleTiling"},B.prototype.getWidth=function(){return this.paper.width},B.prototype.getHeight=function(){return this.paper.height},B.prototype.setBackgroundColor=function(t){this.paper.canvas.style.backgroundColor=t},B.prototype.setViewBox=function(t){this.paper.setViewBox(t.getX(),t.getY(),t.getWidth(),t.getHeight(),!1)},B.prototype.hexColor=function(t){var e=Raphael.color(t);if(e.error)throw new Error("Error: invalid color");return e.hex},C.prototype.getDisplayBox=function(){return this.displayBox},C.prototype.displayBoxString=function(){return this.displayBox.getX().toString().concat(" ",this.displayBox.getY().toString()," ",this.displayBox.getWidth().toString()," ",this.displayBox.getHeight().toString())},C.prototype.setDisplayBox=function(t){this.displayBox=t,this.updateTransform()},C.prototype.updateTransform=function(){var t=new r(this.displayBox.getCenterX(),this.displayBox.getCenterY()),e=Raphael.matrix(),i=1;0!==this.displayBox.getWidth()&&0!==this.c.getWidth()?i=0!==this.displayBox.getHeight()&&0!==this.c.getHeight()?Math.min(this.c.getWidth()/this.displayBox.getWidth(),this.c.getHeight()/this.displayBox.getHeight()):this.c.getWidth()/this.displayBox.getWidth():0!==this.displayBox.getHeight()&&0!==this.c.getHeight()&&(i=this.c.getHeight()/this.displayBox.getHeight()),e.scale(i,i);var n=new r(e.x(t.getX(),t.getY()),e.y(t.getX(),t.getY())),s=-n.getX()+this.c.getWidth()/2,o=-n.getY()+this.c.getHeight()/2;e.translate(s/i,o/i),this.currentTransform=e},C.prototype.toScreenCoordinates=function(t){return new r(this.currentTransform.x(t.getX(),t.getY()),this.currentTransform.y(t.getX(),t.getY()))},C.prototype.toMathCoordinates=function(t){var e=this.getInverseTransform();return new r(e.x(t.getX(),t.getY()),e.y(t.getX(),t.getY()))},C.prototype.getTransform=function(){return this.currentTransform},C.prototype.getInverseTransform=function(){return this.currentTransform.invert()},C.prototype.transformString=function(){return this.currentTransform.toTransformString()},C.prototype.scale=function(t,e){if(0<t){var i=e||new r(this.displayBox.getCenterX(),this.displayBox.getCenterY());this.setDisplayBox(new h(t*(this.displayBox.getX()-i.getX())+i.getX(),t*(this.displayBox.getY()-i.getY())+i.getY(),t*this.displayBox.getWidth(),t*this.displayBox.getHeight()))}},C.prototype.shiftUp=function(t){var e=this.displayBox.getHeight()*I.screenShift;this.setDisplayBox(new h(this.displayBox.getX(),this.displayBox.getY()-t*e,this.displayBox.getWidth(),this.displayBox.getHeight()))},C.prototype.shiftRight=function(t){var e=this.displayBox.getWidth()*I.screenShift;this.setDisplayBox(new h(this.displayBox.getX()+t*e,this.displayBox.getY(),this.displayBox.getWidth(),this.displayBox.getHeight()))},X.prototype.render=function(){this.p=this.d.component.paper.path(this.d.p.getPath().toString()),this.p.transform(this.d.tm.transformString()),this.p.attr({fill:I.polyColor,stroke:I.polyStrokeColor})},X.prototype.render2=function(){this.p.transform(""),this.p.transform(this.d.tm.transformString())},X.prototype.clear=function(){var t=this.p.copy();this.d.component.paper.remove(this.p),this.p=t()},k.prototype.getPolygon=function(){return this.edge.getPolygon()},k.prototype.next=function(){var t=this.edge.getI();this.edge=this.edge.nextEdge();for(var e=this.s.add(this.dir);0<=o.triangleSign(this.s,this.edge.end(),e);)if(this.edge=this.edge.nextEdge(),this.edge.getI()===t)throw new Error("Failed to continue path due to numerical errors!");return this.s=this.s.join(e).intersect(this.edge.toLine()),this.dir=this.edge.reflectDir(this.dir).neg(),this.edge=this.edge.opposite(),this.s},V.prototype.reset=function(){this.s=this.d.p.getCenterOfMass();var t=this.d.p.getEdge(0);this.e=t.start().scale(2).add(t.end()).scale(1/3),this.traj=[],this.polys=[],this.trajectoryPath=null,this.polygonPathSet=[],this.circles=[]},V.prototype.computeTrajectory=function(){this.clearLayerObjects(),this.trajectoryPath=null,this.polygonPathSet=[],this.circles=[],this.traj=[],this.polys=[],this.traj.push(this.s);for(var t=new k(this.d.p,this.s,this.e),e=!0;this.traj.length<=this.L&&e;){var i;this.polys.push(t.getPolygon()),(i=t.next())?this.traj.push(i):e=!1}},V.prototype.setIterations=function(t){this.L=t},V.prototype.render=function(){var t=this;this.computeTrajectory(),this.polys.forEach(function(e){var i=t.d.component.paper.path(e.getPath().toString());i.attr({stroke:I.polyStrokeColor}),i.transform(t.d.tm.transformString()),t.polygonPathSet.push(i)});for(var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(this.traj,1)[0],i="M".concat(e.getX().toString(),",").concat(e.getY().toString()),n=1;n<this.traj.length;n++){var r=this.traj[n];i+="L".concat(r.getX().toString(),",").concat(r.getY().toString())}if(this.trajectoryPath=this.d.component.paper.path(i),this.trajectoryPath.attr({stroke:I.orbitColor}),this.trajectoryPath.transform(this.d.tm.transformString()),1<this.traj.length){var s=this.traj[this.traj.length-1],o=this.d.tm.toScreenCoordinates(s),a=this.d.component.paper.ellipse(o.getX(),o.getY(),this.R,this.R);a.attr({fill:I.endTrajectoryColor}),this.circles.push([a,s])}var h=this.d.tm.toScreenCoordinates(this.s),l=this.d.tm.toScreenCoordinates(this.e),c=this.d.component.paper.ellipse(h.getX(),h.getY(),this.R,this.R),u=this.d.component.paper.ellipse(l.getX(),l.getY(),this.R,this.R);c.attr({fill:I.startCircleColor}),u.attr({fill:I.endCircleColor}),c.drag(this.dragEvents.move,this.dragEvents.start,this.dragEvents.end),u.drag(this.dragEvents.move,this.dragEvents.start,this.dragEvents.end),c.layer=this,u.layer=this,c.pointObject=this.s,u.pointObject=this.e,c.tm=this.d.tm,u.tm=this.d.tm,c.canEscapePolygon=!1,u.canEscapePolygon=!0,this.circles.push([c,this.s]),this.circles.push([u,this.e])},V.prototype.render2=function(){var t=this;this.polygonPathSet.forEach(function(e){e.transform(""),e.transform(t.d.tm.transformString())}),this.circles.forEach(function(e){var i=t.d.tm.toScreenCoordinates(e[1]);e[0].attr({cx:i.getX(),cy:i.getY()})}),this.trajectoryPath.transform(""),this.trajectoryPath.transform(this.d.tm.transformString())},V.prototype.clearLayerObjects=function(){null!==this.trajectoryPath&&this.trajectoryPath.remove(),this.polygonPathSet.forEach(function(t){t.remove()}),this.circles.forEach(function(t){t[0].undrag(),t[0].remove()})},V.prototype.shiftEndPointRight=function(t,e){if(e){var i=new r(this.s.getX()+t,this.s.getY());this.pointInsideStartPolygon(i)&&(this.s=i)}var n=this.e.getX(),s=this.e.getY();this.e=new r(n+t,s)},V.prototype.shiftEndPointUp=function(t,e){if(e){var i=new r(this.s.getX(),this.s.getY()-t);this.pointInsideStartPolygon(i)&&(this.s=i)}var n=this.e.getX(),s=this.e.getY();this.e=new r(n,s-t)},V.prototype.pointInsideStartPolygon=function(t){for(var e=0;e<this.d.p.numSides();e++){var i=this.d.p.getEdge(e);if(o.rightOf(i,t))return!1}return!0},V.prototype.dragEvents={start:function(){this.preDragFill=this.attr("fill"),this.ox=this.attr("cx"),this.oy=this.attr("cy"),this.attr({fill:I.draggingCircleColor})},move:function(t,e){(this.canEscapePolygon||this.layer.pointInsideStartPolygon(this.tm.toMathCoordinates(new r(this.ox+t,this.oy+e))))&&this.attr({cx:this.ox+t,cy:this.oy+e})},end:function(){this.attr({fill:this.preDragFill});var t=this.tm.toMathCoordinates(new r(this.attr("cx"),this.attr("cy")));this.pointObject.x=t.getX(),this.pointObject.y=t.getY(),this.layer.render()}},L.prototype.move=function(t,e){switch(I.directionMap[e]){case 0:this.d.tm.shiftUp(1);break;case 1:this.d.tm.shiftRight(-1);break;case 2:this.d.tm.shiftUp(-1);break;case 3:this.d.tm.shiftRight(1);break;default:throw new Error("Error: invalid direction")}this.polyLayer.render2(),this.trajLayer.render2()},L.prototype.zoom=function(t,e){switch(e){case"r":this.d.tm.setDisplayBox(this.initialDisplayBox);break;default:this.d.tm.scale(I.zoomScaleMap[e])}this.polyLayer.render2(),this.trajLayer.render2()},L.prototype.setZoomBox=function(){this.zoomBox=this.d.component.paper.rect(0,0,0,0)},L.prototype.moveTrajPoints=function(t,e){var i=e.split("+"),n=2===i.length;switch(2===i.length?I.directionMap[i[1]]:I.directionMap[i[0]]){case 0:this.trajLayer.shiftEndPointUp(I.nudgeAmt,n);break;case 1:this.trajLayer.shiftEndPointRight(-I.nudgeAmt,n);break;case 2:this.trajLayer.shiftEndPointUp(-I.nudgeAmt,n);break;case 3:this.trajLayer.shiftEndPointRight(I.nudgeAmt,n);break;default:throw new Error("Error: invalid direction")}this.trajLayer.render()},L.prototype.mouseEvent=function(t){switch(t.type){case"mousedown":t.ctrlKey&&(this.fixX=t.clientX,this.fixY=t.clientY,this.zoomBox=this.d.component.paper.rect(this.fixX,this.fixY,0,0),this.zoomBox.attr({stroke:I.zoomBoxStrokeColor}));break;case"mousemove":if(null!==this.zoomBox){var e=t.clientX,i=t.clientY,n=this.fixX>e?e:this.fixX,s=this.fixY>i?i:this.fixY,o=this.fixX>e?this.fixX:e,a=this.fixY>i?this.fixY:i;this.zoomBox.attr({x:n,y:s,width:o-n,height:a-s})}break;case"mouseup":if(null!==this.zoomBox){var l=this.d.tm.toMathCoordinates(new r(this.zoomBox.attr("x"),this.zoomBox.attr("y"))),c=this.d.tm.toMathCoordinates(new r(this.zoomBox.attr("x")+this.zoomBox.attr("width"),this.zoomBox.attr("y")+this.zoomBox.attr("height"))),u=new h(l.getX(),c.getY(),c.getX()-l.getX(),c.getY()-l.getY());this.d.tm.setDisplayBox(u),this.trajLayer.render2(),this.polyLayer.render2(),this.zoomBox.remove(),this.zoomBox=null}}},L.prototype.toggleHelpBox=function(){"true"===$("#my-modal").attr("aria-hidden")&&$("#help-popup").fadeToggle()},L.prototype.setIterations=function(t){this.trajLayer.setIterations(t),this.trajLayer.render()},(q.prototype=Object.create(c.prototype)).getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},q.prototype.compareTo=function(t){return F.compare(this,t)},(D.prototype=Object.create(q.prototype)).numSides=function(){return 4},D.prototype.getOpposite=function(t){switch(t){case 0:return new a(new z(this.tiling,this.a,this.b-1),2);case 1:return new a(new z(this.tiling,this.a+1,this.b-1),4);case 2:return new a(new z(this.tiling,this.a+1,this.b),6);case 3:return new a(new z(this.tiling,this.a,this.b),0);default:throw new Error("Called getOpposite() on a Octasquare with invalid i=".concat(t))}},(z.prototype=Object.create(q.prototype)).numSides=function(){return 8},z.prototype.getOpposite=function(t){switch(t){case 0:return new a(new D(this.tiling,this.a,this.b),3);case 1:return new a(new z(this.tiling,this.a+1,this.b),5);case 2:return new a(new D(this.tiling,this.a,this.b+1),0);case 3:return new a(new z(this.tiling,this.a,this.b+1),7);case 4:return new a(new D(this.tiling,this.a-1,this.b+1),1);case 5:return new a(new z(this.tiling,this.a-1,this.b),1);case 6:return new a(new D(this.tiling,this.a-1,this.b),2);case 7:return new a(new z(this.tiling,this.a,this.b-1),3);default:throw new Error("Called getOpposite() on a Octagon with invalid i=".concat(t))}},F.prototype.getOriginPolygon=function(){return new z(this,0,0)},F.prototype.toString=function(){return"OctagonSquareTiling"},window.currentFrame=null,$(window).load(function(){window.currentFrame=N(new w(.5,.3))}),$(".new-tiling, #set-iters").click(function(t){t.preventDefault(),function(t){switch(t){case"hexagon-triangle":window.currentFrame=N(new O);break;case"octagon-square":window.currentFrame=N(new F);break;default:!function(t){var e,i,n,r=T[t];$("#error-messages").empty(),$("#my-modal-label").html(r.name),$("#modal-form").html((i=t,n='<p class="help-block">'.concat((e=r).message,"</p>"),"set-iters"===i&&(n+="The current number of iterations is <b>".concat(window.currentFrame.trajLayer.L,"</b>.")),e.parameters.forEach(function(t){n+='<div class="form-group">',n+='<div class="input-group">',n+='<span class="input-group-addon">',n+=t.name,n+="</span>",n+='<input name = "',n+=t.id,n+='" type="text" class="form-control" placeholder="',n+="".concat(t.placeholder,'">'),n+='<span class="glyphicon form-control-feedback"></span>',n+="</div>",n+="</div>"}),n)),$("#modal-form-submit").on("click",function(t){t.preventDefault(),$("#modal-form").submit()}),$("#my-modal").on("hidden.bs.modal",function(){$("#modal-form").find("input[type=text], textarea").val("")}),$("#modal-form").unbind("submit").on("submit",function(e){e.preventDefault();var i=!0,n=$(this).serializeArray();if($("#error-messages").empty(),n.forEach(function(t){if(t.value=parseFloat(t.value),isNaN(t.value))H("".concat(t.name," must be a real number!"),t.name),i=!1;else{var e=function(t,e){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];if(n.id===e)return n}throw new Error("findParameterByID called when no parameter had ID")}(r.parameters,t.name);!function(t,e){var i=e>=t.minInclusive,n=e>t.minExclusive,r=e<=t.maxInclusive,s=e<t.maxExclusive;return!(i&&n&&r&&s)}(e,t.value)?function(t){var e=$("input[name=".concat(t,"]")).parent(".input-group").parent(".form-group");e.removeClass("has-error"),e.addClass("has-feedback has-success"),e.children(".input-group").children(".glyphicon").removeClass("glyphicon-remove"),e.children(".input-group").children(".glyphicon").addClass("glyphicon-ok"),$("#error-messages > #".concat(t)).remove()}(t.name):(H("".concat(e.placeholder," is out of bounds!"),t.name),i=!1)}}),i){var s=n.map(function(t){return t.value});if(T[t].newTiling){var o=new T[t].tiling(s);window.currentFrame=N(o)}else"set-iters"===t&&window.currentFrame.setIterations(s[0]);$("#my-modal").modal("hide")}}),$("#my-modal").modal()}(t)}}(t.target.id)}),$("#zoom-out").click(function(t){t.preventDefault(),window.currentFrame.zoom(null,"o")}),$("#zoom-in").click(function(t){t.preventDefault(),window.currentFrame.zoom(null,"i")}),$("#zoom-reset").click(function(t){t.preventDefault(),window.currentFrame.zoom(null,"r")}),$("#save-as").click(function(t){t.preventDefault()}),$("#open-file").click(function(t){t.preventDefault()}),$("#do-nothing").click(function(t){t.preventDefault()}),$("#plot-trajectory").click(function(t){t.preventDefault()}),$("#help-dialog").click(function(t){t.preventDefault(),window.currentFrame.toggleHelpBox()}),$("#help-close").click(function(t){t.preventDefault(),window.currentFrame.toggleHelpBox()})}]);