!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e,i){this.a=t,this.b=e,this.c=i}function s(t,e){this.x=t,this.y=e}i.r(e),n.prototype.intersect=function(t){const e=this.a*t.b-this.b*t.a;if(0===e)throw new Error("Error: lines do not intersect");return new s((this.b*t.c-this.c*t.b)/e,(this.c*t.a-this.a*t.c)/e)},s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s.prototype.subtract=function(t){return new s(this.x-t.x,this.y-t.y)},s.prototype.add=function(t){return new s(this.x+t.x,this.y+t.y)},s.prototype.rotate90Clockwise=function(){return new s(this.y,-this.x)},s.prototype.rotate90CounterClockwise=function(){return new s(-this.y,this.x)},s.prototype.dot=function(t){return this.x*t.x+this.y*t.y},s.prototype.scale=function(t){return new s(t*this.x,t*this.y)},s.prototype.normalize=function(){return this.scale(1/this.norm())},s.prototype.neg=function(){return new s(-this.x,-this.y)},s.prototype.toString=function(){return`(${this.x.toString()}, ${this.y.toString()})`},s.prototype.midpoint=function(t){return new s((this.x+t.x)/2,(this.y+t.y)/2)},s.prototype.join=function(t){return new n(this.y-t.y,t.x-this.x,this.x*t.y-this.y*t.x)},s.prototype.cxConj=function(){return new s(this.x,-this.y)},s.prototype.normSquared=function(){return this.x*this.x+this.y*this.y},s.prototype.norm=function(){return Math.sqrt(this.normSquared())},s.prototype.cxInv=function(){return this.cxConj().scale(1/this.normSquared())},s.prototype.cxMult=function(t){return new s(this.x*t.x-this.y*t.y,this.x*t.y+this.y*t.x)};const r={triangleSign(t,e,i){const n=e.getX()-t.getX(),s=e.getY()-t.getY(),o=i.getX()-t.getX(),h=n*(i.getY()-t.getY())-s*o;return r.signum(h)},rightOf:(t,e)=>r.triangleSign(t.start(),e,t.end())>0,lengthSquared:t=>(t.start().getX()-t.end().getX())*(t.start().getX()-t.end().getX())+(t.start().getY()-t.end().getY())*(t.start().getY()-t.end().getY()),reflectIn(t,e){const i=e.subtract(t.start()),n=t.end().subtract(t.start());return i.cxMult(n.cxConj()).cxConj().cxMult(n).scale(1/n.normSquared()).add(t.start())},reflectDir(t,e){const i=t.end().subtract(t.start());return e.cxMult(i.cxConj()).cxConj().cxMult(i).scale(1/i.normSquared())},signum:t=>0===t?0:t>0?1:-1};var o=r;function h(t,e){this.p=t,this.i=e>=0?e%this.p.numSides():this.p.numSides()-e%this.p.numSides()}function a(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}function l(){this.xValues=[],this.yValues=[],this.startX=null,this.startY=null,this.closed=!1}function p(){this.tiling=null}function c(t,e,i){p.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[new s(0,0),new s(this.tiling.t,0),new s(1,0),new s(1,1),new s(1-this.tiling.t,1),new s(0,1)],this.xt=new s(1,0),this.yt=new s(1-this.tiling.t,1)}function u(t){this.t=t}function g(t,e,i){p.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[new s(0,0),new s(1,0),new s(this.tiling.x+1,this.tiling.y),new s(this.tiling.x,this.tiling.y)],this.xt=new s(1,0),this.yt=new s(this.tiling.x,this.tiling.y)}function d(t,e){this.x=t,this.y=e}function y(t,e,i){p.call(this),this.tiling=t,this.a=e,this.b=i}function m(t,e,i){y.call(this,t,e,i),this.v=[new s(1,0),new s(this.tiling.x+1,this.tiling.y),new s(this.tiling.x,this.tiling.y)],this.xt=new s(1,0),this.yt=new s(this.tiling.x,this.tiling.y)}function w(t,e,i){y.call(this,t,e,i),this.v=[new s(0,0),new s(1,0),new s(this.tiling.x,this.tiling.y)],this.xt=new s(1,0),this.yt=new s(this.tiling.x,this.tiling.y)}function f(t,e){this.x=t,this.y=e}function x(t,e,i){p.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[],this.xt=new s(this.tiling.m,this.tiling.n),this.yt=new s(-this.tiling.n,this.tiling.m)}function b(t,e,i){x.call(this,t,e,i),this.v=[new s(this.tiling.m,0),new s(this.tiling.m+this.tiling.n,0),new s(this.tiling.m+this.tiling.n,this.tiling.n),new s(this.tiling.m,this.tiling.n)]}function v(t,e,i){x.call(this,t,e,i),this.v=[new s(0,0),new s(this.tiling.n,0),new s(this.tiling.m,0),new s(this.tiling.m,this.tiling.n),new s(this.tiling.m,this.tiling.m),new s(this.tiling.m-this.tiling.n,this.tiling.m),new s(0,this.tiling.m),new s(0,this.tiling.m-this.tiling.n)]}function S(t,e){if(t>e)this.m=t,this.n=e;else{if(!(e>t))throw new Error("called new TwoSquareTiling(length1,length2) with length1 = length2");this.m=e,this.n=t}}h.prototype.getI=function(){return this.i},h.prototype.end=function(){return this.p.getV(this.i+1)},h.prototype.start=function(){return this.p.getV(this.i)},h.prototype.nextEdge=function(){return new h(this.p,this.i+1)},h.prototype.previousEdge=function(){return new h(this.p,this.i+1)},h.prototype.opposite=function(){return this.p.getO(this.i)},h.prototype.getMidpoint=function(){return this.start().midpoint(this.end())},h.prototype.reflect=function(t){return o.reflectIn(this,t)},h.prototype.reflectDir=function(t){return o.reflectDir(this,t)},h.prototype.getPolygon=function(){return this.p},h.prototype.toLine=function(){return this.start().join(this.end())},a.prototype.getX=function(){return this.x},a.prototype.getY=function(){return this.y},a.prototype.getWidth=function(){return this.width},a.prototype.getHeight=function(){return this.height},a.prototype.getCenterX=function(){return this.getMinX()+this.width/2},a.prototype.getCenterY=function(){return this.getMinY()+this.height/2},a.prototype.getMinX=function(){return this.x},a.prototype.getMinY=function(){return this.y-this.height},l.prototype.moveTo=function(t,e){this.xValues=[],this.yValues=[],this.xValues.push(t),this.yValues.push(e),this.closed=!1,this.startX=t,this.startY=e},l.prototype.lineTo=function(t,e){if(closed)throw new Error("Attempting to manipulate a closed path.");this.xValues.push(t),this.yValues.push(e)},l.prototype.copy=function(){const t=new l;return t.xValues=this.xValues.slice(0),t.yValues=this.yValues.slice(0),t.startX=this.startX,t.startY=this.startY,t.closed=this.closed,t},l.prototype.closePath=function(){this.closed=!0,this.xValues.push(this.startX),this.yValues.push(this.startY)},l.prototype.toString=function(){let t=`M${this.xValues[0].toString()},${this.yValues[0].toString()}`;for(let e=1;e<this.xValues.length;e++)t=`${t}L${this.xValues[e].toString()},${this.yValues[e].toString()}`;return t},l.prototype.getBoundingBox=function(){const t=Raphael.pathBBox(this.toString());return new a(t.x,t.y2,t.width,t.height)},p.prototype.getV=function(t){const e=t%this.numSides();return e<0?this.getVertex(e+this.numSides()):this.getVertex(e)},p.prototype.getEdge=function(t){return new h(this,t)},p.prototype.getO=function(t){const e=t%this.numSides();return e<0?this.getOpposite(e+this.numSides()):this.getOpposite(e)},p.prototype.getPath=function(){const t=new l;let e=this.getVertex(0);t.moveTo(e.getX(),e.getY());for(let i=1;i<this.numSides();i++)e=this.getVertex(i),t.lineTo(e.getX(),e.getY());return t.closePath(),t},p.prototype.getCenterOfMass=function(){let t=0,e=0;const i=this.numSides();for(let n=0;n<i;n++){const i=this.getVertex(n);t+=i.getX(),e+=i.getY()}return new s(t/i,e/i)},p.prototype.tilingToString=function(){return this.tiling.toString()},c.prototype=Object.create(p.prototype),c.prototype.numSides=function(){return 6},c.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},c.prototype.getOpposite=function(t){switch(t){case 0:return new h(new c(this.tiling,this.a,this.b-1),3);case 1:return new h(new c(this.tiling,this.a+1,this.b-1),4);case 2:return new h(new c(this.tiling,this.a+1,this.b),5);case 3:return new h(new c(this.tiling,this.a,this.b+1),0);case 4:return new h(new c(this.tiling,this.a-1,this.b+1),1);case 5:return new h(new c(this.tiling,this.a-1,this.b),2);default:throw new Error("Called getOpposite() with invalid i.")}},u.prototype.getOriginPolygon=function(){return new c(this,0,0)},u.prototype.toString=function(){return`BrickTiling ${this.t.toString()}`},u.prototype.fromParameters=function(t){const[e]=t;return new u(e)},g.prototype=Object.create(p.prototype),g.prototype.numSides=function(){return 4},g.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},g.prototype.getOpposite=function(t){switch(t){case 0:return new h(new g(this.tiling,this.a,this.b-1),2);case 1:return new h(new g(this.tiling,this.a+1,this.b),3);case 2:return new h(new g(this.tiling,this.a,this.b+1),0);case 3:return new h(new g(this.tiling,this.a-1,this.b),1);default:throw new Error("Called getOpposite() with invalid i.")}},d.prototype.getOriginPolygon=function(){return new g(this,0,0)},d.prototype.toString=function(){return`ParallelogramTiling ${this.x.toString()} ${this.y.toString()}`},d.prototype.fromParameters=function(t){const[e,i]=t;return new d(e*Math.cos(i*Math.PI/180),e*Math.sin(i*Math.PI/180))},y.prototype=Object.create(p.prototype),y.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},m.prototype=Object.create(y.prototype),m.prototype.numSides=function(){return 3},m.prototype.getOpposite=function(t){switch(t){case 0:return new h(new w(this.tiling,this.a+1,this.b),2);case 1:return new h(new w(this.tiling,this.a,this.b+1),0);case 2:return new h(new w(this.tiling,this.a,this.b),1);default:throw new Error(`Called getOpposite() on a DownTriangle with invalid i=${t}`)}},w.prototype=Object.create(y.prototype),w.prototype.numSides=function(){return 3},w.prototype.getOpposite=function(t){switch(t){case 0:return new h(new m(this.tiling,this.a,this.b-1),1);case 1:return new h(new m(this.tiling,this.a,this.b),2);case 2:return new h(new m(this.tiling,this.a-1,this.b),0);default:throw new Error(`Called getOpposite() on a UpTriangle with invalid i=${t}`)}},f.prototype.getOriginPolygon=function(){return new w(this,0,0)},f.prototype.fromParameters=function(t){const[e]=t,i=t[1]*Math.PI/180;return new f(e*Math.cos(i),e*Math.sin(i))},f.prototype.fromAngles=function(t){const e=t[0]*Math.PI/180,i=t[1]*Math.PI/180;return new f(Math.tan(e)/(Math.tan(i)+Math.tan(e)),Math.tan(e)*Math.tan(i)/(Math.tan(i)+Math.tan(e)))},x.prototype=Object.create(p.prototype),x.prototype.translate=function(t,e){return new s(t+this.a*this.tiling.m-this.b*this.tiling.n,e+this.a*this.tiling.n+this.b*this.tiling.m)},x.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},b.prototype=Object.create(x.prototype),b.prototype.numSides=function(){return 4},b.prototype.getOpposite=function(t){switch(t){case 0:return new h(new v(this.tiling,this.a,this.b-1),4);case 1:return new h(new v(this.tiling,this.a+1,this.b-1),6);case 2:return new h(new v(this.tiling,this.a+1,this.b),0);case 3:return new h(new v(this.tiling,this.a,this.b),2);default:throw new Error("Called getOpposite() with invalid i.")}},v.prototype=Object.create(x.prototype),v.prototype.numSides=function(){return 8},v.prototype.getOpposite=function(t){switch(t){case 0:return new h(new b(this.tiling,this.a-1,this.b),2);case 1:return new h(new v(this.tiling,this.a,this.b-1),5);case 2:return new h(new b(this.tiling,this.a,this.b),3);case 3:return new h(new v(this.tiling,this.a+1,this.b),7);case 4:return new h(new b(this.tiling,this.a,this.b+1),4);case 5:return new h(new v(this.tiling,this.a,this.b+1),1);case 6:return new h(new b(this.tiling,this.a-1,this.b+1),1);case 7:return new h(new v(this.tiling,this.a-1,this.b),3);default:throw new Error("Called getOpposite() with invalid i.")}},S.prototype.toString=function(){return`TwoSquareTiling ${this.m} ${this.n}`},S.prototype.getOriginPolygon=function(){return new v(this,0,0)},S.prototype.fromParameters=function(t){const[e,i]=t;return e!==i?new S(e,i):new u(0)};var I={initialDisplayBoxScale:5,nudgeAmt:.015,screenShift:.02,trajectoryEndpointRadius:5,trajectoryIters:100,backgroundColor:"white",polyColor:"lightgrey",polyStrokeColor:"blue",orbitColor:"red",startCircleColor:"green",endCircleColor:"red",draggingCircleColor:"yellow",endTrajectoryColor:"pink",zoomBoxStrokeColor:"orange",directionMap:{up:0,left:1,down:2,right:3,w:0,a:1,s:2,d:3},zoomScaleMap:{i:.9,o:1.1},moveTrajPointsMap:{alt:!1,shift:!0}},T={"set-iters":{name:"Set Iterations",message:`This sets the number of iterations computed, N. The default is ${I.trajectoryIters}.`+" We won't enforce a maximum, but even 10,000 takes a while.",parameters:[{name:"Iterations",placeholder:"N",id:"N",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY}],newTiling:!1,tiling:void 0},parallelogram:{name:"Parallelogram Tiling",message:"This window sets the tiling to the standard tiling by parallelograms with  sides of length 1 and L, and an angle &#952; measured in degrees.",parameters:[{name:"Length",placeholder:"L",id:"L",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY},{name:"Angle",placeholder:"&#952;",id:"theta",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180}],newTiling:!0,tiling:d.prototype.fromParameters},triangle:{name:"Triangle Tiling",message:"This window sets the tiling to the standard tiling by triangulated parallelograms with sides of length 1 and L, and an angle &#952; measured in  degrees. The diagonal is opposite &#952;.",parameters:[{name:"Length",placeholder:"L",id:"L",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY},{name:"Angle",placeholder:"&#952;",id:"theta",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180}],newTiling:!0,tiling:f.prototype.fromParameters},"triangle-angles":{name:"Triangle Tiling",message:"This window sets the tiling to the standard tiling by triangulated parallelograms with angles &#966; and &#952; (both measured in degrees), and a base  length of 1. The diagonal is opposite &#952;.",parameters:[{name:"Angle &#966;",placeholder:"&#966;",id:"phi",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180},{name:"Angle &#952;",placeholder:"&#952;",id:"theta",minInclusive:0,minExclusive:0,maxInclusive:180,maxExclusive:180}],newTiling:!0,tiling:f.prototype.fromAngles},brick:{name:"Brick Tiling",message:"This window constructs the tiling by square bricks with offset T, a real number between zero and one.",parameters:[{name:"Offset",placeholder:"T",id:"T",minInclusive:0,minExclusive:Number.NEGATIVE_INFINITY,maxInclusive:1,maxExclusive:Number.POSITIVE_INFINITY}],newTiling:!0,tiling:u.prototype.fromParameters},"two-square":{name:"Two Square Tiling",message:"This window sets the tiling to two-square tiling with side-lengths L<sub>1</sub> and L<sub>2</sub>.",parameters:[{name:"Length 1",placeholder:"L_1",id:"L_1",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY},{name:"Length 2",placeholder:"L_2",id:"L_2",minInclusive:0,minExclusive:0,maxInclusive:Number.POSITIVE_INFINITY,maxExclusive:Number.POSITIVE_INFINITY}],newTiling:!0,tiling:S.prototype.fromParameters}};function E(t,e,i){p.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[],this.xt=new s(2,0),this.yt=new s(-1,Math.sqrt(3))}function j(t,e,i){E.call(this,t,e,i),this.v=[new s(1,0),new s(1.5,Math.sqrt(3)/2),new s(.5,Math.sqrt(3)/2)]}function P(t,e,i){E.call(this,t,e,i),this.v=[new s(1,0),new s(.5,-Math.sqrt(3)/2),new s(1.5,-Math.sqrt(3)/2)]}function M(t,e,i){E.call(this,t,e,i),this.v=[new s(1,0),new s(.5,Math.sqrt(3)/2),new s(-.5,Math.sqrt(3)/2),new s(-1,0),new s(-.5,-Math.sqrt(3)/2),new s(.5,-Math.sqrt(3)/2)]}function B(){}function O(t){this.paper=t}function C(t,e){this.displayBox=t,this.currentTransform=new Raphael.matrix(1,0,0,0,1,0),this.c=e}function Y(t){this.d=t,this.p=null}function X(t,e,i){for(this.s=e,this.dir=i.subtract(this.s).normalize(),this.edge=t.getEdge(0);o.triangleSign(i,this.edge.start(),this.s)<=0;)if(this.edge=this.edge.nextEdge(),0===this.edge.getI())throw new Error("WHAT IS HAPPENING");for(;o.triangleSign(i,this.edge.end(),this.s)>0;)this.edge=this.edge.nextEdge()}function k(t){this.d=t,this.s=null,this.e=null,this.traj=[],this.polys=[],this.L=I.trajectoryIters,this.R=I.trajectoryEndpointRadius,this.orbitColor=I.orbitColor,this.trajectoryPath=null,this.polygonPathSet=[],this.circles=[],this.reset()}function V(t,e){this.d=new function(t,e,i){this.component=t,this.tm=new C(new a(-2,2,4,4),t),this.p=e,this.frame=i}(e,t,this),this.d.tm.setDisplayBox(t.getPath().getBoundingBox()),this.d.tm.scale(I.initialDisplayBoxScale),this.initialDisplayBox=this.d.tm.getDisplayBox(),this.polyLayer=new Y(this.d),this.polyLayer.render(),this.zoomBox=null,this.trajLayer=new k(this.d),this.trajLayer.render(),Mousetrap.bind("up",this.move.bind(this)),Mousetrap.bind("left",this.move.bind(this)),Mousetrap.bind("down",this.move.bind(this)),Mousetrap.bind("right",this.move.bind(this)),Mousetrap.bind("o",this.zoom.bind(this)),Mousetrap.bind("i",this.zoom.bind(this)),Mousetrap.bind("r",this.zoom.bind(this)),Mousetrap.bind("w",this.moveTrajPoints.bind(this)),Mousetrap.bind("a",this.moveTrajPoints.bind(this)),Mousetrap.bind("s",this.moveTrajPoints.bind(this)),Mousetrap.bind("d",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+w",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+a",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+s",this.moveTrajPoints.bind(this)),Mousetrap.bind("shift+d",this.moveTrajPoints.bind(this)),Mousetrap.bind("esc",this.toggleHelpBox.bind(this)),document.onmousedown=this.mouseEvent.bind(this),document.onmouseup=this.mouseEvent.bind(this),document.onmousemove=this.mouseEvent.bind(this)}function L(t){const e=window.innerWidth,i=window.innerHeight,n=new O(Raphael(0,0,e,i));return n.setBackgroundColor(I.backgroundColor),window.frame=new V(t.getOriginPolygon(),n),window.frame}function N(t,e,i){p.call(this),this.tiling=t,this.a=e,this.b=i,this.v=[],this.xt=new s(2+Math.sqrt(2),-2-Math.sqrt(2)),this.yt=new s(2+Math.sqrt(2),2+Math.sqrt(2))}function q(t,e,i){N.call(this,t,e,i),this.v=[new s(0,0),new s(0,-2),new s(2,-2),new s(2,0)]}function D(t,e,i){N.call(this,t,e,i),this.v=[new s(0,0),new s(2,0),new s(2+Math.sqrt(2),Math.sqrt(2)),new s(2+Math.sqrt(2),2+Math.sqrt(2)),new s(2,2+2*Math.sqrt(2)),new s(0,2+2*Math.sqrt(2)),new s(-Math.sqrt(2),2+Math.sqrt(2)),new s(-Math.sqrt(2),Math.sqrt(2))]}function z(){}function F(t,e){const i=$(`input[name=${e}]`).parent(".input-group").parent(".form-group");i.removeClass("has-success"),i.addClass("has-feedback has-error"),i.children(".input-group").children(".glyphicon").removeClass("glyphicon-ok"),i.children(".input-group").children(".glyphicon").addClass("glyphicon-remove"),$("#error-messages").append(`<span id="${e}">${t}</span><br>`)}E.prototype=Object.create(p.prototype),E.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},E.prototype.compareTo=function(t){return B.compare(this,t)},j.prototype=Object.create(E.prototype),j.prototype.numSides=function(){return 3},j.prototype.getOpposite=function(t){switch(t){case 0:return new h(new M(this.tiling,this.a+1,this.b),2);case 1:return new h(new M(this.tiling,this.a+1,this.b+1),4);case 2:return new h(new M(this.tiling,this.a,this.b),0);default:throw new Error(`Called getOpposite() on a HexDownTriangle with invalid i=${t}`)}},P.prototype=Object.create(E.prototype),P.prototype.numSides=function(){return 3},P.prototype.getOpposite=function(t){switch(t){case 0:return new h(new M(this.tiling,this.a,this.b),5);case 1:return new h(new M(this.tiling,this.a,this.b-1),1);case 2:return new h(new M(this.tiling,this.a+1,this.b),3);default:throw new Error(`Called getOpposite() on a HexUpTriangle with invalid i=${t}`)}},M.prototype=Object.create(E.prototype),M.prototype.numSides=function(){return 6},M.prototype.getOpposite=function(t){switch(t){case 0:return new h(new j(this.tiling,this.a,this.b),2);case 1:return new h(new P(this.tiling,this.a,this.b+1),1);case 2:return new h(new j(this.tiling,this.a-1,this.b),0);case 3:return new h(new P(this.tiling,this.a-1,this.b),2);case 4:return new h(new j(this.tiling,this.a-1,this.b-1),1);case 5:return new h(new P(this.tiling,this.a,this.b),0);default:throw new Error(`Called getOpposite() on a Hexagon with invalid i=${t}`)}},B.prototype.getOriginPolygon=function(){return new M(this,0,0)},B.prototype.toString=function(){return"HexagonTriangleTiling"},O.prototype.getWidth=function(){return this.paper.width},O.prototype.getHeight=function(){return this.paper.height},O.prototype.setBackgroundColor=function(t){this.paper.canvas.style.backgroundColor=t},O.prototype.setViewBox=function(t){this.paper.setViewBox(t.getX(),t.getY(),t.getWidth(),t.getHeight(),!1)},O.prototype.hexColor=function(t){const e=Raphael.color(t);if(e.error)throw new Error("Error: invalid color");return e.hex},C.prototype.getDisplayBox=function(){return this.displayBox},C.prototype.displayBoxString=function(){return this.displayBox.getX().toString().concat(" ",this.displayBox.getY().toString()," ",this.displayBox.getWidth().toString()," ",this.displayBox.getHeight().toString())},C.prototype.setDisplayBox=function(t){this.displayBox=t,this.updateTransform()},C.prototype.updateTransform=function(){const t=new s(this.displayBox.getCenterX(),this.displayBox.getCenterY()),e=Raphael.matrix();let i=1;0!==this.displayBox.getWidth()&&0!==this.c.getWidth()?i=0!==this.displayBox.getHeight()&&0!==this.c.getHeight()?Math.min(this.c.getWidth()/this.displayBox.getWidth(),this.c.getHeight()/this.displayBox.getHeight()):this.c.getWidth()/this.displayBox.getWidth():0!==this.displayBox.getHeight()&&0!==this.c.getHeight()&&(i=this.c.getHeight()/this.displayBox.getHeight()),e.scale(i,i);const n=new s(e.x(t.getX(),t.getY()),e.y(t.getX(),t.getY())),r=-n.getX()+this.c.getWidth()/2,o=-n.getY()+this.c.getHeight()/2;e.translate(r/i,o/i),this.currentTransform=e},C.prototype.toScreenCoordinates=function(t){return new s(this.currentTransform.x(t.getX(),t.getY()),this.currentTransform.y(t.getX(),t.getY()))},C.prototype.toMathCoordinates=function(t){const e=this.getInverseTransform();return new s(e.x(t.getX(),t.getY()),e.y(t.getX(),t.getY()))},C.prototype.getTransform=function(){return this.currentTransform},C.prototype.getInverseTransform=function(){return this.currentTransform.invert()},C.prototype.transformString=function(){return this.currentTransform.toTransformString()},C.prototype.scale=function(t,e){if(t>0){const i=e||new s(this.displayBox.getCenterX(),this.displayBox.getCenterY());this.setDisplayBox(new a(t*(this.displayBox.getX()-i.getX())+i.getX(),t*(this.displayBox.getY()-i.getY())+i.getY(),t*this.displayBox.getWidth(),t*this.displayBox.getHeight()))}},C.prototype.shiftUp=function(t){const e=this.displayBox.getHeight()*I.screenShift;this.setDisplayBox(new a(this.displayBox.getX(),this.displayBox.getY()-t*e,this.displayBox.getWidth(),this.displayBox.getHeight()))},C.prototype.shiftRight=function(t){const e=this.displayBox.getWidth()*I.screenShift;this.setDisplayBox(new a(this.displayBox.getX()+t*e,this.displayBox.getY(),this.displayBox.getWidth(),this.displayBox.getHeight()))},Y.prototype.render=function(){this.p=this.d.component.paper.path(this.d.p.getPath().toString()),this.p.transform(this.d.tm.transformString()),this.p.attr({fill:I.polyColor,stroke:I.polyStrokeColor})},Y.prototype.render2=function(){this.p.transform(""),this.p.transform(this.d.tm.transformString())},Y.prototype.clear=function(){const t=this.p.copy();this.d.component.paper.remove(this.p),this.p=t()},X.prototype.getPolygon=function(){return this.edge.getPolygon()},X.prototype.next=function(){const t=this.edge.getI();this.edge=this.edge.nextEdge();const e=this.s.add(this.dir);for(;o.triangleSign(this.s,this.edge.end(),e)>=0;)if(this.edge=this.edge.nextEdge(),this.edge.getI()===t)throw new Error("Failed to continue path due to numerical errors!");return this.s=this.s.join(e).intersect(this.edge.toLine()),this.dir=this.edge.reflectDir(this.dir).neg(),this.edge=this.edge.opposite(),this.s},k.prototype.reset=function(){this.s=this.d.p.getCenterOfMass();const t=this.d.p.getEdge(0);this.e=t.start().scale(2).add(t.end()).scale(1/3),this.traj=[],this.polys=[],this.trajectoryPath=null,this.polygonPathSet=[],this.circles=[]},k.prototype.computeTrajectory=function(){this.clearLayerObjects(),this.trajectoryPath=null,this.polygonPathSet=[],this.circles=[],this.traj=[],this.polys=[],this.traj.push(this.s);const t=new X(this.d.p,this.s,this.e);let e=!0;for(;this.traj.length<=this.L&&e;){this.polys.push(t.getPolygon());let i=null;try{i=t.next()}catch(t){console.error(t)}i?this.traj.push(i):e=!1}},k.prototype.setIterations=function(t){this.L=t},k.prototype.render=function(){this.computeTrajectory(),this.polys.forEach(t=>{const e=this.d.component.paper.path(t.getPath().toString());e.attr({stroke:I.polyStrokeColor}),e.transform(this.d.tm.transformString()),this.polygonPathSet.push(e)});const[t]=this.traj;let e=`M${t.getX().toString()},${t.getY().toString()}`;for(let t=1;t<this.traj.length;t++){const i=this.traj[t];e+=`L${i.getX().toString()},${i.getY().toString()}`}if(this.trajectoryPath=this.d.component.paper.path(e),this.trajectoryPath.attr({stroke:I.orbitColor}),this.trajectoryPath.transform(this.d.tm.transformString()),this.traj.length>1){const t=this.traj[this.traj.length-1],e=this.d.tm.toScreenCoordinates(t),i=this.d.component.paper.ellipse(e.getX(),e.getY(),this.R,this.R);i.attr({fill:I.endTrajectoryColor}),this.circles.push([i,t])}const i=this.d.tm.toScreenCoordinates(this.s),n=this.d.tm.toScreenCoordinates(this.e),s=this.d.component.paper.ellipse(i.getX(),i.getY(),this.R,this.R),r=this.d.component.paper.ellipse(n.getX(),n.getY(),this.R,this.R);s.attr({fill:I.startCircleColor}),r.attr({fill:I.endCircleColor}),s.drag(this.dragEvents.move,this.dragEvents.start,this.dragEvents.end),r.drag(this.dragEvents.move,this.dragEvents.start,this.dragEvents.end),s.layer=this,r.layer=this,s.pointObject=this.s,r.pointObject=this.e,s.tm=this.d.tm,r.tm=this.d.tm,s.canEscapePolygon=!1,r.canEscapePolygon=!0,this.circles.push([s,this.s]),this.circles.push([r,this.e])},k.prototype.render2=function(){this.polygonPathSet.forEach(t=>{t.transform(""),t.transform(this.d.tm.transformString())}),this.circles.forEach(t=>{const e=this.d.tm.toScreenCoordinates(t[1]);t[0].attr({cx:e.getX(),cy:e.getY()})}),this.trajectoryPath.transform(""),this.trajectoryPath.transform(this.d.tm.transformString())},k.prototype.clearLayerObjects=function(){null!==this.trajectoryPath&&this.trajectoryPath.remove(),this.polygonPathSet.forEach(t=>{t.remove()}),this.circles.forEach(t=>{t[0].undrag(),t[0].remove()})},k.prototype.shiftEndPointRight=function(t,e){if(e){const e=new s(this.s.getX()+t,this.s.getY());this.pointInsideStartPolygon(e)&&(this.s=e)}const i=this.e.getX(),n=this.e.getY();this.e=new s(i+t,n)},k.prototype.shiftEndPointUp=function(t,e){if(e){const e=new s(this.s.getX(),this.s.getY()-t);this.pointInsideStartPolygon(e)&&(this.s=e)}const i=this.e.getX(),n=this.e.getY();this.e=new s(i,n-t)},k.prototype.pointInsideStartPolygon=function(t){for(let e=0;e<this.d.p.numSides();e++){const i=this.d.p.getEdge(e);if(o.rightOf(i,t))return!1}return!0},k.prototype.dragEvents={start(){this.preDragFill=this.attr("fill"),this.ox=this.attr("cx"),this.oy=this.attr("cy"),this.attr({fill:I.draggingCircleColor})},move(t,e){(this.canEscapePolygon||this.layer.pointInsideStartPolygon(this.tm.toMathCoordinates(new s(this.ox+t,this.oy+e))))&&this.attr({cx:this.ox+t,cy:this.oy+e})},end(){this.attr({fill:this.preDragFill});const t=this.tm.toMathCoordinates(new s(this.attr("cx"),this.attr("cy")));this.pointObject.x=t.getX(),this.pointObject.y=t.getY(),this.layer.render()}},V.prototype.move=function(t,e){switch(I.directionMap[e]){case 0:this.d.tm.shiftUp(1);break;case 1:this.d.tm.shiftRight(-1);break;case 2:this.d.tm.shiftUp(-1);break;case 3:this.d.tm.shiftRight(1);break;default:throw new Error("Error: invalid direction")}this.polyLayer.render2(),this.trajLayer.render2()},V.prototype.zoom=function(t,e){switch(e){case"r":this.d.tm.setDisplayBox(this.initialDisplayBox);break;default:this.d.tm.scale(I.zoomScaleMap[e])}this.polyLayer.render2(),this.trajLayer.render2()},V.prototype.setZoomBox=function(){this.zoomBox=this.d.component.paper.rect(0,0,0,0)},V.prototype.moveTrajPoints=function(t,e){const i=e.split("+"),n=2===i.length;switch(2===i.length?I.directionMap[i[1]]:I.directionMap[i[0]]){case 0:this.trajLayer.shiftEndPointUp(I.nudgeAmt,n);break;case 1:this.trajLayer.shiftEndPointRight(-I.nudgeAmt,n);break;case 2:this.trajLayer.shiftEndPointUp(-I.nudgeAmt,n);break;case 3:this.trajLayer.shiftEndPointRight(I.nudgeAmt,n);break;default:throw new Error("Error: invalid direction")}this.trajLayer.render()},V.prototype.mouseEvent=function(t){switch(t.type){case"mousedown":t.ctrlKey&&(this.fixX=t.clientX,this.fixY=t.clientY,this.zoomBox=this.d.component.paper.rect(this.fixX,this.fixY,0,0),this.zoomBox.attr({stroke:I.zoomBoxStrokeColor}));break;case"mousemove":if(null!==this.zoomBox){const e=t.clientX,i=t.clientY,n=this.fixX>e?e:this.fixX,s=this.fixY>i?i:this.fixY,r=this.fixX>e?this.fixX:e,o=this.fixY>i?this.fixY:i;this.zoomBox.attr({x:n,y:s,width:r-n,height:o-s})}break;case"mouseup":if(null!==this.zoomBox){const t=this.d.tm.toMathCoordinates(new s(this.zoomBox.attr("x"),this.zoomBox.attr("y"))),e=this.d.tm.toMathCoordinates(new s(this.zoomBox.attr("x")+this.zoomBox.attr("width"),this.zoomBox.attr("y")+this.zoomBox.attr("height"))),i=new a(t.getX(),e.getY(),e.getX()-t.getX(),e.getY()-t.getY());this.d.tm.setDisplayBox(i),this.trajLayer.render2(),this.polyLayer.render2(),this.zoomBox.remove(),this.zoomBox=null}}},V.prototype.toggleHelpBox=function(){"true"===$("#my-modal").attr("aria-hidden")&&$("#help-popup").fadeToggle()},V.prototype.setIterations=function(t){this.trajLayer.setIterations(t),this.trajLayer.render()},N.prototype=Object.create(p.prototype),N.prototype.getVertex=function(t){return this.v[t].add(this.xt.scale(this.a)).add(this.yt.scale(this.b))},N.prototype.compareTo=function(t){return z.compare(this,t)},q.prototype=Object.create(N.prototype),q.prototype.numSides=function(){return 4},q.prototype.getOpposite=function(t){switch(t){case 0:return new h(new D(this.tiling,this.a,this.b-1),2);case 1:return new h(new D(this.tiling,this.a+1,this.b-1),4);case 2:return new h(new D(this.tiling,this.a+1,this.b),6);case 3:return new h(new D(this.tiling,this.a,this.b),0);default:throw new Error(`Called getOpposite() on a Octasquare with invalid i=${t}`)}},D.prototype=Object.create(N.prototype),D.prototype.numSides=function(){return 8},D.prototype.getOpposite=function(t){switch(t){case 0:return new h(new q(this.tiling,this.a,this.b),3);case 1:return new h(new D(this.tiling,this.a+1,this.b),5);case 2:return new h(new q(this.tiling,this.a,this.b+1),0);case 3:return new h(new D(this.tiling,this.a,this.b+1),7);case 4:return new h(new q(this.tiling,this.a-1,this.b+1),1);case 5:return new h(new D(this.tiling,this.a-1,this.b),1);case 6:return new h(new q(this.tiling,this.a-1,this.b),2);case 7:return new h(new D(this.tiling,this.a,this.b-1),3);default:throw new Error(`Called getOpposite() on a Octagon with invalid i=${t}`)}},z.prototype.getOriginPolygon=function(){return new D(this,0,0)},z.prototype.toString=function(){return"OctagonSquareTiling"},window.currentFrame=null,$(window).load(()=>{window.currentFrame=L(new f(.5,.3))}),$(".new-tiling, #set-iters").click(t=>{t.preventDefault(),function(t){switch(t){case"hexagon-triangle":window.currentFrame=L(new B);break;case"octagon-square":window.currentFrame=L(new z);break;default:!function(t){const e=T[t];$("#error-messages").empty(),$("#my-modal-label").html(e.name),$("#modal-form").html(function(t,e){let i=`<p class="help-block">${t.message}</p>`;return"set-iters"===e&&(i+=`The current number of iterations is <b>${window.currentFrame.trajLayer.L}</b>.`),t.parameters.forEach(t=>{i+='<div class="form-group">',i+='<div class="input-group">',i+='<span class="input-group-addon">',i+=t.name,i+="</span>",i+='<input name = "',i+=t.id,i+='" type="text" class="form-control" placeholder="',i+=`${t.placeholder}">`,i+='<span class="glyphicon form-control-feedback"></span>',i+="</div>",i+="</div>"}),i}(e,t)),$("#modal-form-submit").on("click",t=>{t.preventDefault(),$("#modal-form").submit()}),$("#my-modal").on("hidden.bs.modal",()=>{$("#modal-form").find("input[type=text], textarea").val("")}),$("#modal-form").unbind("submit").on("submit",function(i){i.preventDefault();let n=!0;const s=$(this).serializeArray();if($("#error-messages").empty(),s.forEach(t=>{if(t.value=parseFloat(t.value),isNaN(t.value))F(`${t.name} must be a real number!`,t.name),n=!1;else{const i=function(t,e){for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const n=t[i];if(n.id===e)return n}throw new Error("findParameterByID called when no parameter had ID")}(e.parameters,t.name);!function(t,e){const i=e>=t.minInclusive,n=e>t.minExclusive,s=e<=t.maxInclusive,r=e<t.maxExclusive;return!(i&&n&&s&&r)}(i,t.value)?function(t){const e=$(`input[name=${t}]`).parent(".input-group").parent(".form-group");e.removeClass("has-error"),e.addClass("has-feedback has-success"),e.children(".input-group").children(".glyphicon").removeClass("glyphicon-remove"),e.children(".input-group").children(".glyphicon").addClass("glyphicon-ok"),$(`#error-messages > #${t}`).remove()}(t.name):(F(`${i.placeholder} is out of bounds!`,t.name),n=!1)}}),n){const e=s.map(t=>t.value);if(T[t].newTiling){const i=new T[t].tiling(e);window.currentFrame=L(i)}else"set-iters"===t&&window.currentFrame.setIterations(e[0]);$("#my-modal").modal("hide")}}),$("#my-modal").modal()}(t)}}(t.target.id)}),$("#zoom-out").click(t=>{t.preventDefault(),window.currentFrame.zoom(null,"o")}),$("#zoom-in").click(t=>{t.preventDefault(),window.currentFrame.zoom(null,"i")}),$("#zoom-reset").click(t=>{t.preventDefault(),window.currentFrame.zoom(null,"r")}),$("#save-as").click(t=>{t.preventDefault()}),$("#open-file").click(t=>{t.preventDefault()}),$("#do-nothing").click(t=>{t.preventDefault()}),$("#plot-trajectory").click(t=>{t.preventDefault()}),$("#help-dialog").click(t=>{t.preventDefault(),window.currentFrame.toggleHelpBox()}),$("#help-close").click(t=>{t.preventDefault(),window.currentFrame.toggleHelpBox()})}]);